# 7510. В поисках привлекательного фрагмента

**Решена** | **Сложная**

---

Вы всё Кондесуром тщательно изучали ядро. Наконец, подняв взгляд, вы замираете:

> Принцесса Брейс сидит на троне — и злодеуше улыбается — «Что… происходит?…» — шепчет Кодерун. — Это не она… Она… заражена…

— Нет, — отвечает злодеуший голос CTRodent’a. — Она переписана. Моем кодом.

Злодей внедрился в сознание Принцессы и теперь циклично переразыгрывает её личность, делая её — подчиненной, коварной, злодеушей…

Свет маячит мерцанием. С потолка слышатся осколки фресок. Мир вокруг сотрясается… Неужели это конец?

— Скорее! У нас ещё есть шанс! — кричит Кодерун. — Если мы найдём в её сознании хоть бы один привлекательный фрагмент — цикл прервётся!

Перед вами — двойная строка с длиной n — начальный отпечаток сознания Принцессы Брейс. Подстрока u чётной длины m называется привлекательной, если существует такая позиция 1 ≤ i ≤ m — i + 1, что u₁wₙ — i. Над строкой с происходит следующий процесс:

- случайно и равновероятно выбирается одна из всех её подстрок чётной длины;
- если выбранная подстрока является привлекательной — процесс завершается;
- иначе, каждый символ этой подстроки с вероятностью 1/2 меняется на противоположный, и процесс повторяется.

Ваша задача — посчитать математическое ожидание числа шагов в процессе, где шагом считается каждый раз, когда выполняется первое действие (случайный выбор подстроки).

---

## Формат ввода

В единственной строке вам дан двоичный строка, состоящая из 0 и 1, записанных без пробелов, длиной не менее 2 и не более 18.

## Формат вывода

В качестве ответа вам нужно вывести найденное математическое ожидание.

Ответ необходимо найти по модулю 998244353. Формально, пусть \( M = 998244353 \). Можно показать, что ответ может быть представлен в виде несократимой дроби \( a/b \), где a и b целые числа и \( b \neq 0 \) (mod \( M \)). Верните целое число, равное \( a \cdot b^{-1} \) (mod \( M \)). Другими словами, верните такое целое число \( c \), что \( 0 \leq c < M \), и \( c \cdot b \equiv a \pmod{M} \).

---

## Примечание

### Определения

Подстрока \( [l, r] \) — набор элементов строки, индексы которых лежат в промежутке \( l / d \), то есть элементы \( (a_l, a_{l+1}, \ldots, a_r) \).

### Ограничения

- Ограничение времени: 1 с
- Ограничение памяти: 1 ГБ


---

## Пример 1
**Ввод:**  
01

**Вывод:**  
3

---

### Пример 2
**Ввод:**  
1001


**Вывод:**  
205986932

---

### Пример 3
**Ввод:**  
110001110111001011

**Вывод:**  
477812917