# 7508. Древние тоннели

**Решена** | **Средняя**

---

Ура, КОДЕРУН вернулся!  
Ты его нашёл! Наконец-то! Теперь всё наладится!

— Я пустил злопод. Но я узнал, что это. Это CTRodent — артефакт старой версии системы. Он хочет вернуть 32-битную архитектуру. А для этого он собирается полностью снести весь этот мир!

Кодерун смог выяснить коварный план CTRodent'a. Негодяй собирается пробраться в дворец по древним, построенным ещё в эпоху dial-up-у, одноплановым подземным тоннелям.

Подземелье представляет из себя `n (1 < n < 2 · 10^5)` различных комнат, соединённых одноплановыми тоннелями. Комнаты можно проходить исключительно в определённом порядке, заданном массивом `a` размера n. Из комнаты с номером i можно попасть в комнату с номером `a_i`. Если `a_i = -1` (тупиковая комната) или i; уже посещалась, то дальше продолжать движение запрещено.

Чтобы перекрыть пути доступа к дворцу, нужно выяснить для каждого i, сколько существует различных маршрутов в подземелье, заканчивающихся в i-й комнате, если начать можно из любой комнаты. Способы прохождения считаются различными, если они содержат различные комнаты или если порядок комнат отличается.

## Формат ввода

Каждый тест состоит из нескольких наборов входных данных. Первая строка содержит количество наборов входных данных `1 ≤ t ≤ 3 · 10^4`. Далее следует описание наборов входных данных.

Первая строка каждого набора входных данных содержит целое число `n (1 ≤ n ≤ 2 · 10^5)`.

Вторая строка содержит `n` целых чисел — описание массива `a` (`a_i = -1 или 1 ≤ a_i ≤ n, a_i ≠ i`).

Гарантируется, что сумма `n` по всем наборам входных данных не превышает `2 · 10^5`.

## Формат вывода

Для каждого набора входных данных в отдельной строке выведите `n` целых чисел, где `i` — число обозначает количество различных способов прохождения, оканчивающихся в `i`-й комнате.

## Примечание

В первом наборе входных данных для `i = 1` есть только один вариант — начать с 1-й комнаты.

Во втором наборе входных данных есть два варианта дойти до первой комнаты: 1,2 → 1; и для второй комнаты: 2,1 → 2.

В третьем наборе входных данных есть три варианта дойти до 2-й комнаты:
- 1 → 2 → 3 → 2;
- и по одному для первой и третьей комнаты (1 и 3 соответственно).

## Ограничения

- Ограничение времени: 2с
- Ограничение памяти: 256 МБ


---

## Примеры

### Пример 1

| Ввод | Вывод |
|-------|--------|
| 6  |  1 | 
| |1  | 2 2  | 
| -1  | 1 3 1  | 
| 2  | 1 3 1 4  | 
| 2 1  | 1 3 2 3 3  | 
| 3  | 2 1 2 3 2 1 1 | 
| 2 -1 2  |   | 
| 4  |   | 
| 2 4 2 -1  |   | 
| 5  |   | 
| 3 5 -1 2 4  |   | 
| 7  |   | 
| 3 -1 1 -1 4 5 -1   |       |


---
