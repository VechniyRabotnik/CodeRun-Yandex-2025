# 7513. Это конец?

**Решена** | **Сложная**

---


Что случилось? Вдруг стало темно и тихо. Вы не чувствуете ни дуновения ветра, ни даже призракации...

— Неужели это конец? — ты слышишь чей-то голос, а потом понимаешь, что самозадал этот вопрос.

— Это конец... и начало, — звучит ответ. Голос спокойный, мягкий, тёплый. Это голос Принцессы Брейс.

Ты открываешь глаза.

Перед тобой — бесконечное полотно чистого кода. Оно колышется, переливается, подчиняясь твоим мыслям. Всё, что ты только можешь вообразить, может обрести форму...

Принцесса касается полотна — и рождается массив.

— Это массив будущего — говорит она. — Он определяет то, что произойдет дальше, но не фиксирует. Будущее зависит от твоего выбора. Оно может быть хаотичным... или стать гармоничным, если ты найдешь правильный модуль.

В твоих руках массив _ из _ целых чисел.

Назовем подотрезок этого массива \([l, r]\), _k_-интересным (\(k \ge 1\)), если существует такое целое число \(m \ge k\), что \(\mod m = a_{l+1} \mod m = a_{l+2} \mod m = ... = a_{r}\), где \(a_i\) — элемент массива.

Тебе предстоит ответить на \(q\) запросов.

Каждый запрос — тройка \((l, r, k)\). В ответ на запрос посчитайте количество _k_-интересных подотрезков массива \(a[l, r]\). То есть, найдите количество таких пар \((l_1, r_1)\), что \(l \le l_1 \le r_1 \le r\) и подотрезор \([l_1, r_1]\) является _k_-привлекательным.

Будущее этого мира — в твоих руках!

## Формат ввода

В первой строке дано число \(1 \le n \le 5 \cdot 10^4\), обозначающее число элементов массива и количество запросов. В следующей строке заданы элементы массива — натуральные числа от 1 до \(10^9\). В следующих \(q\) строках заданы запросы. Каждая строка содержит тройку \((l, r, k)\), где \(1 \le l \le r \le n\), \(1 \le k \le 10^9\).

## Формат вывода

Для каждого запроса выведите ответ на него в отдельной строке. Всё зависит только от тебя!

## Примечание

### Определения
Подотрезок массива \(a[l, r]\) — набор элементов массива, индексы которых лежат в промежутке от \(l\) до \(r\), то есть элементы \((a_l, a_{l+1}, ..., a_r)\).

### Ограничения
- Ограничение времени: 3 с
- Ограничение памяти: 256 МБ


---

## Примеры

### Пример 1

| Ввод | Вывод |
|-------|--------|
| 5 2  | 4  |
|12 6 4 16 8  | 10 |
|1 5 4  |  |
|1 5 2   |       |


---

### Пример 2

| Ввод | Вывод |
|-------|--------|
| 5 10  | 2 |
|36 36 81 72 72  | 4 |
|1 5 47  | 2 |
|1 5 36  | 10  |
|1 5 63  | 4 |
|1 5 9  | 4 |
|1 5 12  | 4 |
|1 5 30  | 2 |
|1 5 45  | 10 |
|1 5 46  | 2 |
|1 5 9  |  |
|1 5 89   |       |

---

### Пример 3

| Ввод | Вывод |
|-------|--------|
|10 20  | 0 |
|64 64 64 32 80 80 36 90 36 54  | 5 |
|6 6 24  | 11 |
|2 8 48  | 1 |
|2 10 26  | 6 |
|8 9 24  | 1 |
|4 8 9  | 10 |
|5 9 60  | 3 |
|2 6 1  | 1 |
|6 8 1  | 3 |
|8 9 3  | 4 |
|5 7 23  | 9 |
|5 10 48  | 13  |
|5 10 15  | 4 |
|3 9 4  | 3  |
|1 6 80  | 11 |
|6 10 48  | 4 |
|2 10 27  | 3 |
|4 8 45  | 12 |
|2 4 25  | 2 |
|2 7 16  |  |
|2 10 81   |       |
