# 7513. Это конец?

**Решена** | **Сложная**

Что случилось? Вдруг стало темно и тихо. Вы не чувствуете ни дуновения ветра, ни даже призракации...

— Неужели это конец? — ты слышишь чей-то голос, а потом понимаешь, что самозадал этот вопрос.

— Это конец... и начало, — звучит ответ. Голос спокойный, мягкий, тёплый. Это голос Принцессы Брейс.

Ты открываешь глаза.

Перед тобой — бесконечное полотно чистого кода. Оно колышется, переливается, подчиняясь твоим мыслям. Всё, что ты только можешь вообразить, может обрести форму...

Принцесса касается полотна — и рождается массив.

— Это массив будущего — говорит она. — Он определяет то, что произойдет дальше, но не фиксирует. Будущее зависит от твоего выбора. Оно может быть хаотичным... или стать гармоничным, если ты найдешь правильный модуль.

В твоих руках массив _ из _ целых чисел.

Назовем подотрезок этого массива \([l, r]\), _k_-интересным (\(k \ge 1\)), если существует такое целое число \(m \ge k\), что \(\mod m = a_{l+1} \mod m = a_{l+2} \mod m = ... = a_{r}\), где \(a_i\) — элемент массива.

Тебе предстоит ответить на \(q\) запросов.

Каждый запрос — тройка \((l, r, k)\). В ответ на запрос посчитайте количество _k_-интересных подотрезков массива \(a[l, r]\). То есть, найдите количество таких пар \((l_1, r_1)\), что \(l \le l_1 \le r_1 \le r\) и подотрезор \([l_1, r_1]\) является _k_-привлекательным.

Будущее этого мира — в твоих руках!

## Формат ввода

В первой строке дано число \(1 \le n \le 5 \cdot 10^4\), обозначающее число элементов массива и количество запросов. В следующей строке заданы элементы массива — натуральные числа от 1 до \(10^9\). В следующих \(q\) строках заданы запросы. Каждая строка содержит тройку \((l, r, k)\), где \(1 \le l \le r \le n\), \(1 \le k \le 10^9\).

## Формат вывода

Для каждого запроса выведите ответ на него в отдельной строке. Всё зависит только от тебя!

## Примечание

### Определения
Подотрезок массива \(a[l, r]\) — набор элементов массива, индексы которых лежат в промежутке от \(l\) до \(r\), то есть элементы \((a_l, a_{l+1}, ..., a_r)\).

### Ограничения
- Ограничение времени: 3 с
- Ограничение памяти: 256 МБ


---

## Пример 1
**Ввод:**  
5 2
12 6 4 16 8
1 5 4
1 5 2

**Вывод:**  
4
10

---

### Пример 2
**Ввод:**  
5 10
36 36 81 72 72
1 5 47
1 5 36
1 5 63
1 5 9
1 5 12
1 5 30
1 5 45
1 5 46
1 5 9
1 5 89


**Вывод:**  
2
4
2
10
4
4
4
2
10
2

---

### Пример 3
**Ввод:**  
10 20
64 64 64 32 80 80 36 90 36 54
6 6 24
2 8 48
2 10 26
8 9 24
4 8 9
5 9 60
2 6 1
6 8 1
8 9 3
5 7 23
5 10 48
5 10 15
3 9 4
1 6 80
6 10 48
2 10 27
4 8 45
2 4 25
2 7 16
2 10 81

**Вывод:**  
0
5
11
1
6
1
10
3
1
3
4
9
13
4
3
11
4
3
12
2